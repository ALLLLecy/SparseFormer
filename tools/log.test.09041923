/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/distributed/launch.py:181: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use-env is set by default in torchrun.
If your script expects `--local-rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
2025-09-04 19:23:27,113   INFO  **********************Start logging**********************
2025-09-04 19:23:27,113   INFO  CUDA_VISIBLE_DEVICES=ALL
2025-09-04 19:23:27,113   INFO  total_batch_size: 16
2025-09-04 19:23:27,113   INFO  cfg_file         cfgs/sparse_models/sparse_former_light.yaml
2025-09-04 19:23:27,113   INFO  batch_size       4
2025-09-04 19:23:27,114   INFO  workers          4
2025-09-04 19:23:27,114   INFO  extra_tag        default
2025-09-04 19:23:27,114   INFO  ckpt             /mnt/csi-data-aly/user/hongfeizhang/mypaper/SparseFormerV2/workdir/voxelnext/encoder/voxelnext_en_3layer_1lc_zhx_de_1layer_v3_32p_.0diff_.1lr_.1wd/ckpt/latest_model.pth
2025-09-04 19:23:27,114   INFO  pretrained_model None
2025-09-04 19:23:27,114   INFO  launcher         pytorch
2025-09-04 19:23:27,114   INFO  tcp_port         18888
2025-09-04 19:23:27,114   INFO  local_rank       0
2025-09-04 19:23:27,114   INFO  set_cfgs         None
2025-09-04 19:23:27,114   INFO  max_waiting_mins 30
2025-09-04 19:23:27,114   INFO  start_epoch      0
2025-09-04 19:23:27,114   INFO  eval_tag         default
2025-09-04 19:23:27,114   INFO  eval_all         False
2025-09-04 19:23:27,114   INFO  ckpt_dir         None
2025-09-04 19:23:27,114   INFO  save_to_file     False
2025-09-04 19:23:27,114   INFO  infer_time       False
2025-09-04 19:23:27,114   INFO  eval_map         False
2025-09-04 19:23:27,114   INFO  dataset          nuscenes
2025-09-04 19:23:27,114   INFO  root_dir         /mnt/csi-data-aly/user/hongfeizhang/mypaper/SparseFormerV2
2025-09-04 19:23:27,114   INFO  output_dir        /mnt/csi-data-aly/user/hongfeizhang/mypaper/SparseFormerV2/workdir/voxelnext/encoder/voxelnext_en_3layer_1lc_zhx_de_1layer_v3_32p_.0diff_.1lr_.1wd
2025-09-04 19:23:27,114   INFO  cfg.ROOT_DIR: /mnt/csi-data-aly/user/hongfeizhang/mypaper/SparseFormerV2
2025-09-04 19:23:27,114   INFO  cfg.LOCAL_RANK: 0
2025-09-04 19:23:27,114   INFO  cfg.CLASS_NAMES: ['car', 'truck', 'construction_vehicle', 'bus', 'trailer', 'barrier', 'motorcycle', 'bicycle', 'pedestrian', 'traffic_cone']
2025-09-04 19:23:27,114   INFO  ----------- DATA_CONFIG -----------
2025-09-04 19:23:27,114   INFO  cfg.DATA_CONFIG.DATASET: NuScenesDataset
2025-09-04 19:23:27,114   INFO  cfg.DATA_CONFIG.DATA_PATH: /mnt/csi-data-aly/user/hongfeizhang/mypaper/SparseFormerV2/data/nuscenes
2025-09-04 19:23:27,114   INFO  cfg.DATA_CONFIG.VERSION: v1.0-trainval
2025-09-04 19:23:27,114   INFO  cfg.DATA_CONFIG.MAX_SWEEPS: 10
2025-09-04 19:23:27,114   INFO  cfg.DATA_CONFIG.PRED_VELOCITY: True
2025-09-04 19:23:27,115   INFO  cfg.DATA_CONFIG.SET_NAN_VELOCITY_TO_ZEROS: True
2025-09-04 19:23:27,115   INFO  cfg.DATA_CONFIG.FILTER_MIN_POINTS_IN_GT: 1
2025-09-04 19:23:27,115   INFO  ----------- DATA_SPLIT -----------
2025-09-04 19:23:27,115   INFO  cfg.DATA_CONFIG.DATA_SPLIT.train: train
2025-09-04 19:23:27,115   INFO  cfg.DATA_CONFIG.DATA_SPLIT.test: val
2025-09-04 19:23:27,115   INFO  ----------- INFO_PATH -----------
2025-09-04 19:23:27,115   INFO  cfg.DATA_CONFIG.INFO_PATH.train: ['nuscenes_infos_10sweeps_train.pkl']
2025-09-04 19:23:27,115   INFO  cfg.DATA_CONFIG.INFO_PATH.test: ['nuscenes_infos_10sweeps_val.pkl']
2025-09-04 19:23:27,115   INFO  cfg.DATA_CONFIG.POINT_CLOUD_RANGE: [-54.0, -54.0, -5.0, 54.0, 54.0, 3.0]
2025-09-04 19:23:27,115   INFO  cfg.DATA_CONFIG.BALANCED_RESAMPLING: True
2025-09-04 19:23:27,115   INFO  ----------- DATA_AUGMENTOR -----------
2025-09-04 19:23:27,115   INFO  cfg.DATA_CONFIG.DATA_AUGMENTOR.DISABLE_AUG_LIST: ['placeholder']
2025-09-04 19:23:27,115   INFO  cfg.DATA_CONFIG.DATA_AUGMENTOR.AUG_CONFIG_LIST: [{'NAME': 'gt_sampling', 'DB_INFO_PATH': ['nuscenes_dbinfos_10sweeps_withvelo.pkl'], 'USE_SHARED_MEMORY': True, 'DB_DATA_PATH': ['nuscenes_10sweeps_withvelo_lidar.npy'], 'PREPARE': {'filter_by_min_points': ['car:5', 'truck:5', 'construction_vehicle:5', 'bus:5', 'trailer:5', 'barrier:5', 'motorcycle:5', 'bicycle:5', 'pedestrian:5', 'traffic_cone:5']}, 'SAMPLE_GROUPS': ['car:2', 'truck:3', 'construction_vehicle:7', 'bus:4', 'trailer:6', 'barrier:2', 'motorcycle:6', 'bicycle:6', 'pedestrian:2', 'traffic_cone:2'], 'NUM_POINT_FEATURES': 5, 'DATABASE_WITH_FAKELIDAR': False, 'REMOVE_EXTRA_WIDTH': [0.0, 0.0, 0.0], 'LIMIT_WHOLE_SCENE': True}, {'NAME': 'random_world_flip', 'ALONG_AXIS_LIST': ['x', 'y']}, {'NAME': 'random_world_rotation', 'WORLD_ROT_ANGLE': [-0.78539816, 0.78539816]}, {'NAME': 'random_world_scaling', 'WORLD_SCALE_RANGE': [0.9, 1.1]}, {'NAME': 'random_world_translation', 'NOISE_TRANSLATE_STD': [0.5, 0.5, 0.5]}]
2025-09-04 19:23:27,115   INFO  ----------- POINT_FEATURE_ENCODING -----------
2025-09-04 19:23:27,115   INFO  cfg.DATA_CONFIG.POINT_FEATURE_ENCODING.encoding_type: absolute_coordinates_encoding
2025-09-04 19:23:27,115   INFO  cfg.DATA_CONFIG.POINT_FEATURE_ENCODING.used_feature_list: ['x', 'y', 'z', 'intensity', 'timestamp']
2025-09-04 19:23:27,116   INFO  cfg.DATA_CONFIG.POINT_FEATURE_ENCODING.src_feature_list: ['x', 'y', 'z', 'intensity', 'timestamp']
2025-09-04 19:23:27,116   INFO  cfg.DATA_CONFIG.DATA_PROCESSOR: [{'NAME': 'mask_points_and_boxes_outside_range', 'REMOVE_OUTSIDE_BOXES': True, 'MASK_Z': True}, {'NAME': 'shuffle_points', 'SHUFFLE_ENABLED': {'train': True, 'test': True}}, {'NAME': 'transform_points_to_voxels_placeholder', 'VOXEL_SIZE': [0.075, 0.075, 0.2]}]
2025-09-04 19:23:27,116   INFO  cfg.DATA_CONFIG._BASE_CONFIG_: cfgs/dataset_configs/nuscenes_dataset.yaml
2025-09-04 19:23:27,116   INFO  ----------- MODEL -----------
2025-09-04 19:23:27,116   INFO  cfg.MODEL.NAME: TransFusion
2025-09-04 19:23:27,116   INFO  ----------- VFE -----------
2025-09-04 19:23:27,116   INFO  cfg.MODEL.VFE.NAME: DynamicVoxelVFE
2025-09-04 19:23:27,116   INFO  cfg.MODEL.VFE.USE_NORM: True
2025-09-04 19:23:27,116   INFO  cfg.MODEL.VFE.WITH_DISTANCE: False
2025-09-04 19:23:27,116   INFO  cfg.MODEL.VFE.USE_ABSLOTE_XYZ: True
2025-09-04 19:23:27,116   INFO  cfg.MODEL.VFE.NUM_FILTERS: [64, 64]
2025-09-04 19:23:27,116   INFO  ----------- BACKBONE_3D -----------
2025-09-04 19:23:27,116   INFO  cfg.MODEL.BACKBONE_3D.NAME: VoxelResBackBone8xVoxelNeXt
2025-09-04 19:23:27,116   INFO  cfg.MODEL.BACKBONE_3D.CHANNELS: [64, 64, 64, 128, 128]
2025-09-04 19:23:27,116   INFO  ----------- DENSE_HEAD -----------
2025-09-04 19:23:27,116   INFO  cfg.MODEL.DENSE_HEAD.NAME: SparseFormerHead
2025-09-04 19:23:27,116   INFO  ----------- SPENCODER -----------
2025-09-04 19:23:27,116   INFO  cfg.MODEL.DENSE_HEAD.SPENCODER.NUM_LAYERS: 3
2025-09-04 19:23:27,116   INFO  cfg.MODEL.DENSE_HEAD.SPENCODER.ORDERS: [['z', 'z-trans'], ['hilbert', 'hilbert-trans'], ['x', 'y']]
2025-09-04 19:23:27,116   INFO  cfg.MODEL.DENSE_HEAD.SPENCODER.WINDOW_SHAPE: [9, 9]
2025-09-04 19:23:27,116   INFO  cfg.MODEL.DENSE_HEAD.SPENCODER.DEPTH: 8
2025-09-04 19:23:27,116   INFO  ----------- SMSA -----------
2025-09-04 19:23:27,116   INFO  cfg.MODEL.DENSE_HEAD.SPENCODER.SMSA.EMBED_DIM: 128
2025-09-04 19:23:27,116   INFO  cfg.MODEL.DENSE_HEAD.SPENCODER.SMSA.DEPTH: 8
2025-09-04 19:23:27,116   INFO  cfg.MODEL.DENSE_HEAD.SPENCODER.SMSA.NUM_LEVELS: 3
2025-09-04 19:23:27,116   INFO  cfg.MODEL.DENSE_HEAD.SPENCODER.SMSA.WINDOW_SHAPE: [9, 9]
2025-09-04 19:23:27,116   INFO  cfg.MODEL.DENSE_HEAD.SPENCODER.SMSA.DROP_PATH: 0.2
2025-09-04 19:23:27,116   INFO  cfg.MODEL.DENSE_HEAD.SPENCODER.SMSA.SPATIAL_ENHANCE: True
2025-09-04 19:23:27,116   INFO  cfg.MODEL.DENSE_HEAD.SPENCODER.SMSA.FUSED_ADD_NORM: True
2025-09-04 19:23:27,116   INFO  cfg.MODEL.DENSE_HEAD.SPENCODER.SMSA.RMS_NORM: True
2025-09-04 19:23:27,116   INFO  cfg.MODEL.DENSE_HEAD.SPENCODER.SMSA.NORM_EPSILON: 1e-05
2025-09-04 19:23:27,116   INFO  cfg.MODEL.DENSE_HEAD.SPENCODER.SMSA.RESIDUAL_IN_FP32: True
2025-09-04 19:23:27,116   INFO  cfg.MODEL.DENSE_HEAD.SPENCODER.SMSA.DIFF_COEF: 0.0
2025-09-04 19:23:27,116   INFO  cfg.MODEL.DENSE_HEAD.SPENCODER.SMSA.DIFF_KERNEL: [7, 5, 3]
2025-09-04 19:23:27,116   INFO  ----------- SPDECODER -----------
2025-09-04 19:23:27,117   INFO  cfg.MODEL.DENSE_HEAD.SPDECODER.NUM_LAYERS: 1
2025-09-04 19:23:27,117   INFO  cfg.MODEL.DENSE_HEAD.SPDECODER.NUM_LEVELS: 3
2025-09-04 19:23:27,117   INFO  cfg.MODEL.DENSE_HEAD.SPDECODER.WINDOW_SHAPE: [[9, 9], [5, 5], [3, 3]]
2025-09-04 19:23:27,117   INFO  cfg.MODEL.DENSE_HEAD.SPDECODER.NUM_POINTS: [32, 32, 32]
2025-09-04 19:23:27,117   INFO  cfg.MODEL.DENSE_HEAD.SPDECODER.DEPTH: [8, 7, 6]
2025-09-04 19:23:27,117   INFO  cfg.MODEL.DENSE_HEAD.SPDECODER.FFN_DIM: 256
2025-09-04 19:23:27,117   INFO  cfg.MODEL.DENSE_HEAD.SPDECODER.DROPOUT: 0.1
2025-09-04 19:23:27,117   INFO  cfg.MODEL.DENSE_HEAD.SPDECODER.NUM_HEADS: 8
2025-09-04 19:23:27,117   INFO  cfg.MODEL.DENSE_HEAD.SPDECODER.FUSION_HEADS: 4
2025-09-04 19:23:27,117   INFO  cfg.MODEL.DENSE_HEAD.SPDECODER.ORDERS: [['x', 'y']]
2025-09-04 19:23:27,117   INFO  ----------- SDCA -----------
2025-09-04 19:23:27,117   INFO  cfg.MODEL.DENSE_HEAD.SPDECODER.SDCA.EMBED_DIM: 128
2025-09-04 19:23:27,117   INFO  cfg.MODEL.DENSE_HEAD.SPDECODER.SDCA.NUM_HEADS: 8
2025-09-04 19:23:27,117   INFO  cfg.MODEL.DENSE_HEAD.SPDECODER.SDCA.DROPOUT: 0.1
2025-09-04 19:23:27,117   INFO  cfg.MODEL.DENSE_HEAD.CLASS_AGNOSTIC: False
2025-09-04 19:23:27,117   INFO  cfg.MODEL.DENSE_HEAD.USE_BIAS_BEFORE_NORM: True
2025-09-04 19:23:27,117   INFO  cfg.MODEL.DENSE_HEAD.USE_TENSOR_MASK: True
2025-09-04 19:23:27,117   INFO  cfg.MODEL.DENSE_HEAD.USE_DENSE_HEATMAP: True
2025-09-04 19:23:27,117   INFO  cfg.MODEL.DENSE_HEAD.INPUT_FEATURES: 128
2025-09-04 19:23:27,117   INFO  cfg.MODEL.DENSE_HEAD.NUM_PROPOSALS: 300
2025-09-04 19:23:27,117   INFO  cfg.MODEL.DENSE_HEAD.HIDDEN_CHANNEL: 128
2025-09-04 19:23:27,117   INFO  cfg.MODEL.DENSE_HEAD.NUM_CLASSES: 10
2025-09-04 19:23:27,117   INFO  cfg.MODEL.DENSE_HEAD.NUM_HEADS: 8
2025-09-04 19:23:27,117   INFO  cfg.MODEL.DENSE_HEAD.NMS_KERNEL_SIZE: 3
2025-09-04 19:23:27,117   INFO  cfg.MODEL.DENSE_HEAD.FFN_CHANNEL: 256
2025-09-04 19:23:27,117   INFO  cfg.MODEL.DENSE_HEAD.DROPOUT: 0.1
2025-09-04 19:23:27,117   INFO  cfg.MODEL.DENSE_HEAD.BN_MOMENTUM: 0.1
2025-09-04 19:23:27,117   INFO  cfg.MODEL.DENSE_HEAD.ACTIVATION: relu
2025-09-04 19:23:27,118   INFO  cfg.MODEL.DENSE_HEAD.NUM_HM_CONV: 2
2025-09-04 19:23:27,118   INFO  ----------- SEPARATE_HEAD_CFG -----------
2025-09-04 19:23:27,118   INFO  cfg.MODEL.DENSE_HEAD.SEPARATE_HEAD_CFG.HEAD_ORDER: ['center', 'height', 'dim', 'rot', 'vel', 'iou']
2025-09-04 19:23:27,118   INFO  ----------- HEAD_DICT -----------
2025-09-04 19:23:27,118   INFO  ----------- center -----------
2025-09-04 19:23:27,118   INFO  cfg.MODEL.DENSE_HEAD.SEPARATE_HEAD_CFG.HEAD_DICT.center.out_channels: 2
2025-09-04 19:23:27,118   INFO  cfg.MODEL.DENSE_HEAD.SEPARATE_HEAD_CFG.HEAD_DICT.center.num_conv: 2
2025-09-04 19:23:27,118   INFO  ----------- height -----------
2025-09-04 19:23:27,118   INFO  cfg.MODEL.DENSE_HEAD.SEPARATE_HEAD_CFG.HEAD_DICT.height.out_channels: 1
2025-09-04 19:23:27,118   INFO  cfg.MODEL.DENSE_HEAD.SEPARATE_HEAD_CFG.HEAD_DICT.height.num_conv: 2
2025-09-04 19:23:27,118   INFO  ----------- dim -----------
2025-09-04 19:23:27,118   INFO  cfg.MODEL.DENSE_HEAD.SEPARATE_HEAD_CFG.HEAD_DICT.dim.out_channels: 3
2025-09-04 19:23:27,118   INFO  cfg.MODEL.DENSE_HEAD.SEPARATE_HEAD_CFG.HEAD_DICT.dim.num_conv: 2
2025-09-04 19:23:27,118   INFO  ----------- rot -----------
2025-09-04 19:23:27,118   INFO  cfg.MODEL.DENSE_HEAD.SEPARATE_HEAD_CFG.HEAD_DICT.rot.out_channels: 2
2025-09-04 19:23:27,118   INFO  cfg.MODEL.DENSE_HEAD.SEPARATE_HEAD_CFG.HEAD_DICT.rot.num_conv: 2
2025-09-04 19:23:27,118   INFO  ----------- vel -----------
2025-09-04 19:23:27,118   INFO  cfg.MODEL.DENSE_HEAD.SEPARATE_HEAD_CFG.HEAD_DICT.vel.out_channels: 2
2025-09-04 19:23:27,118   INFO  cfg.MODEL.DENSE_HEAD.SEPARATE_HEAD_CFG.HEAD_DICT.vel.num_conv: 2
2025-09-04 19:23:27,118   INFO  ----------- iou -----------
2025-09-04 19:23:27,118   INFO  cfg.MODEL.DENSE_HEAD.SEPARATE_HEAD_CFG.HEAD_DICT.iou.out_channels: 1
2025-09-04 19:23:27,118   INFO  cfg.MODEL.DENSE_HEAD.SEPARATE_HEAD_CFG.HEAD_DICT.iou.num_conv: 2
2025-09-04 19:23:27,118   INFO  ----------- TARGET_ASSIGNER_CONFIG -----------
2025-09-04 19:23:27,118   INFO  cfg.MODEL.DENSE_HEAD.TARGET_ASSIGNER_CONFIG.DATASET: nuScenes
2025-09-04 19:23:27,118   INFO  cfg.MODEL.DENSE_HEAD.TARGET_ASSIGNER_CONFIG.FEATURE_MAP_STRIDE: 8
2025-09-04 19:23:27,118   INFO  cfg.MODEL.DENSE_HEAD.TARGET_ASSIGNER_CONFIG.GAUSSIAN_OVERLAP: 0.1
2025-09-04 19:23:27,118   INFO  cfg.MODEL.DENSE_HEAD.TARGET_ASSIGNER_CONFIG.MIN_RADIUS: 2
2025-09-04 19:23:27,118   INFO  ----------- HUNGARIAN_ASSIGNER -----------
2025-09-04 19:23:27,119   INFO  ----------- cls_cost -----------
2025-09-04 19:23:27,119   INFO  cfg.MODEL.DENSE_HEAD.TARGET_ASSIGNER_CONFIG.HUNGARIAN_ASSIGNER.cls_cost.gamma: 2.0
2025-09-04 19:23:27,119   INFO  cfg.MODEL.DENSE_HEAD.TARGET_ASSIGNER_CONFIG.HUNGARIAN_ASSIGNER.cls_cost.alpha: 0.25
2025-09-04 19:23:27,119   INFO  cfg.MODEL.DENSE_HEAD.TARGET_ASSIGNER_CONFIG.HUNGARIAN_ASSIGNER.cls_cost.weight: 0.15
2025-09-04 19:23:27,119   INFO  ----------- reg_cost -----------
2025-09-04 19:23:27,119   INFO  cfg.MODEL.DENSE_HEAD.TARGET_ASSIGNER_CONFIG.HUNGARIAN_ASSIGNER.reg_cost.weight: 0.25
2025-09-04 19:23:27,119   INFO  ----------- iou_cost -----------
2025-09-04 19:23:27,119   INFO  cfg.MODEL.DENSE_HEAD.TARGET_ASSIGNER_CONFIG.HUNGARIAN_ASSIGNER.iou_cost.weight: 0.25
2025-09-04 19:23:27,119   INFO  ----------- LOSS_CONFIG -----------
2025-09-04 19:23:27,119   INFO  ----------- LOSS_WEIGHTS -----------
2025-09-04 19:23:27,119   INFO  cfg.MODEL.DENSE_HEAD.LOSS_CONFIG.LOSS_WEIGHTS.cls_weight: 1.0
2025-09-04 19:23:27,119   INFO  cfg.MODEL.DENSE_HEAD.LOSS_CONFIG.LOSS_WEIGHTS.bbox_weight: 0.25
2025-09-04 19:23:27,119   INFO  cfg.MODEL.DENSE_HEAD.LOSS_CONFIG.LOSS_WEIGHTS.hm_weight: 1.0
2025-09-04 19:23:27,119   INFO  cfg.MODEL.DENSE_HEAD.LOSS_CONFIG.LOSS_WEIGHTS.iou_weight: 0.5
2025-09-04 19:23:27,119   INFO  cfg.MODEL.DENSE_HEAD.LOSS_CONFIG.LOSS_WEIGHTS.iou_reg_weight: 0.5
2025-09-04 19:23:27,119   INFO  cfg.MODEL.DENSE_HEAD.LOSS_CONFIG.LOSS_WEIGHTS.code_weights: [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.2, 0.2]
2025-09-04 19:23:27,119   INFO  ----------- LOSS_CLS -----------
2025-09-04 19:23:27,119   INFO  cfg.MODEL.DENSE_HEAD.LOSS_CONFIG.LOSS_CLS.use_sigmoid: True
2025-09-04 19:23:27,119   INFO  cfg.MODEL.DENSE_HEAD.LOSS_CONFIG.LOSS_CLS.gamma: 2.0
2025-09-04 19:23:27,119   INFO  cfg.MODEL.DENSE_HEAD.LOSS_CONFIG.LOSS_CLS.alpha: 0.25
2025-09-04 19:23:27,119   INFO  cfg.MODEL.DENSE_HEAD.LOSS_CONFIG.LOSS_IOU: True
2025-09-04 19:23:27,119   INFO  cfg.MODEL.DENSE_HEAD.LOSS_CONFIG.LOSS_IOU_REG: True
2025-09-04 19:23:27,119   INFO  ----------- POST_PROCESSING -----------
2025-09-04 19:23:27,119   INFO  cfg.MODEL.DENSE_HEAD.POST_PROCESSING.SCORE_THRESH: 0.0
2025-09-04 19:23:27,119   INFO  cfg.MODEL.DENSE_HEAD.POST_PROCESSING.POST_CENTER_RANGE: [-61.2, -61.2, -10.0, 61.2, 61.2, 10.0]
2025-09-04 19:23:27,119   INFO  cfg.MODEL.DENSE_HEAD.POST_PROCESSING.USE_IOU_TO_RECTIFY_SCORE: True
2025-09-04 19:23:27,119   INFO  cfg.MODEL.DENSE_HEAD.POST_PROCESSING.IOU_RECTIFIER: [0.5]
2025-09-04 19:23:27,119   INFO  ----------- NMS_CONFIG -----------
2025-09-04 19:23:27,119   INFO  cfg.MODEL.DENSE_HEAD.NMS_CONFIG.NMS_TYPE: nms_gpu
2025-09-04 19:23:27,119   INFO  cfg.MODEL.DENSE_HEAD.NMS_CONFIG.NMS_THRESH: 0.2
2025-09-04 19:23:27,119   INFO  cfg.MODEL.DENSE_HEAD.NMS_CONFIG.NMS_PRE_MAXSIZE: 1000
2025-09-04 19:23:27,119   INFO  cfg.MODEL.DENSE_HEAD.NMS_CONFIG.NMS_POST_MAXSIZE: 100
2025-09-04 19:23:27,119   INFO  cfg.MODEL.DENSE_HEAD.NMS_CONFIG.SCORE_THRES: 0.0
2025-09-04 19:23:27,119   INFO  ----------- POST_PROCESSING -----------
2025-09-04 19:23:27,119   INFO  cfg.MODEL.POST_PROCESSING.RECALL_THRESH_LIST: [0.3, 0.5, 0.7]
2025-09-04 19:23:27,119   INFO  cfg.MODEL.POST_PROCESSING.SCORE_THRESH: 0.1
2025-09-04 19:23:27,120   INFO  cfg.MODEL.POST_PROCESSING.OUTPUT_RAW_SCORE: False
2025-09-04 19:23:27,120   INFO  cfg.MODEL.POST_PROCESSING.EVAL_METRIC: kitti
2025-09-04 19:23:27,120   INFO  ----------- NMS_CONFIG -----------
2025-09-04 19:23:27,120   INFO  cfg.MODEL.POST_PROCESSING.NMS_CONFIG.MULTI_CLASSES_NMS: True
2025-09-04 19:23:27,120   INFO  cfg.MODEL.POST_PROCESSING.NMS_CONFIG.NMS_TYPE: nms_gpu
2025-09-04 19:23:27,120   INFO  cfg.MODEL.POST_PROCESSING.NMS_CONFIG.NMS_THRESH: 0.2
2025-09-04 19:23:27,120   INFO  cfg.MODEL.POST_PROCESSING.NMS_CONFIG.NMS_PRE_MAXSIZE: 1000
2025-09-04 19:23:27,120   INFO  cfg.MODEL.POST_PROCESSING.NMS_CONFIG.NMS_POST_MAXSIZE: 83
2025-09-04 19:23:27,120   INFO  ----------- OPTIMIZATION -----------
2025-09-04 19:23:27,120   INFO  cfg.OPTIMIZATION.BATCH_SIZE_PER_GPU: 4
2025-09-04 19:23:27,120   INFO  cfg.OPTIMIZATION.NUM_EPOCHS: 20
2025-09-04 19:23:27,120   INFO  cfg.OPTIMIZATION.OPTIMIZER: adam_onecycle
2025-09-04 19:23:27,120   INFO  cfg.OPTIMIZATION.LR: 0.001
2025-09-04 19:23:27,120   INFO  cfg.OPTIMIZATION.WEIGHT_DECAY: 0.01
2025-09-04 19:23:27,120   INFO  cfg.OPTIMIZATION.MOMENTUM: 0.9
2025-09-04 19:23:27,120   INFO  cfg.OPTIMIZATION.MOMS: [0.95, 0.85]
2025-09-04 19:23:27,120   INFO  cfg.OPTIMIZATION.PCT_START: 0.4
2025-09-04 19:23:27,120   INFO  cfg.OPTIMIZATION.DIV_FACTOR: 10
2025-09-04 19:23:27,120   INFO  cfg.OPTIMIZATION.DECAY_STEP_LIST: [35, 45]
2025-09-04 19:23:27,120   INFO  cfg.OPTIMIZATION.LR_DECAY: 0.1
2025-09-04 19:23:27,120   INFO  cfg.OPTIMIZATION.LR_CLIP: 1e-07
2025-09-04 19:23:27,120   INFO  cfg.OPTIMIZATION.LR_WARMUP: False
2025-09-04 19:23:27,120   INFO  cfg.OPTIMIZATION.WARMUP_EPOCH: 1
2025-09-04 19:23:27,120   INFO  cfg.OPTIMIZATION.GRAD_NORM_CLIP: 35
2025-09-04 19:23:27,120   INFO  cfg.OPTIMIZATION.LOSS_SCALE_FP16: 4.0
2025-09-04 19:23:27,120   INFO  ----------- HOOK -----------
2025-09-04 19:23:27,120   INFO  ----------- DisableAugmentationHook -----------
2025-09-04 19:23:27,120   INFO  cfg.HOOK.DisableAugmentationHook.DISABLE_AUG_LIST: ['gt_sampling']
2025-09-04 19:23:27,120   INFO  cfg.HOOK.DisableAugmentationHook.NUM_LAST_EPOCHS: 4
2025-09-04 19:23:27,120   INFO  cfg.TAG: sparse_former_light
2025-09-04 19:23:27,120   INFO  cfg.EXP_GROUP_PATH: sparse_models
2025-09-04 19:23:27,120   INFO  cfg.OUTPUT_DIR: /mnt/csi-data-aly/user/hongfeizhang/mypaper/SparseFormerV2/tools/ /mnt/csi-data-aly/user/hongfeizhang/mypaper/SparseFormerV2/workdir/voxelnext/encoder/voxelnext_en_3layer_1lc_zhx_de_1layer_v3_32p_.0diff_.1lr_.1wd
2025-09-04 19:23:27,121   INFO  Loading NuScenes dataset
2025-09-04 19:23:27,609   INFO  Total samples for NuScenes dataset: 6019
/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3526.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3526.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3526.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3526.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
2025-09-04 19:23:27,980   INFO  ==> Loading parameters from checkpoint /mnt/csi-data-aly/user/hongfeizhang/mypaper/SparseFormerV2/workdir/voxelnext/encoder/voxelnext_en_3layer_1lc_zhx_de_1layer_v3_32p_.0diff_.1lr_.1wd/ckpt/latest_model.pth to CPU
2025-09-04 19:23:28,188   INFO  ==> Checkpoint trained from version: pcdet+0.6.0+8694e7f
2025-09-04 19:23:28,220   INFO  ==> Done (loaded 695/695)
2025-09-04 19:23:28,248   INFO  *************** EPOCH 1 EVALUATION *****************
nusc-3d-det-val-2025-09-04-19-23-06-master-0:21:21 [0] NCCL INFO Bootstrap : Using eth0:10.245.119.196<0>
nusc-3d-det-val-2025-09-04-19-23-06-master-0:21:21 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v6 symbol.
nusc-3d-det-val-2025-09-04-19-23-06-master-0:21:21 [0] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin symbol (v4 or v5).
nusc-3d-det-val-2025-09-04-19-23-06-master-0:21:21 [0] NCCL INFO cudaDriverVersion 12050
NCCL version 2.18.5+cuda11.8
nusc-3d-det-val-2025-09-04-19-23-06-master-0:24:24 [3] NCCL INFO cudaDriverVersion 12050
nusc-3d-det-val-2025-09-04-19-23-06-master-0:23:23 [2] NCCL INFO cudaDriverVersion 12050
nusc-3d-det-val-2025-09-04-19-23-06-master-0:22:22 [1] NCCL INFO cudaDriverVersion 12050
nusc-3d-det-val-2025-09-04-19-23-06-master-0:24:24 [3] NCCL INFO Bootstrap : Using eth0:10.245.119.196<0>
nusc-3d-det-val-2025-09-04-19-23-06-master-0:22:22 [1] NCCL INFO Bootstrap : Using eth0:10.245.119.196<0>
nusc-3d-det-val-2025-09-04-19-23-06-master-0:23:23 [2] NCCL INFO Bootstrap : Using eth0:10.245.119.196<0>
nusc-3d-det-val-2025-09-04-19-23-06-master-0:22:22 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v6 symbol.
nusc-3d-det-val-2025-09-04-19-23-06-master-0:22:22 [1] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin symbol (v4 or v5).
nusc-3d-det-val-2025-09-04-19-23-06-master-0:24:24 [3] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v6 symbol.
nusc-3d-det-val-2025-09-04-19-23-06-master-0:24:24 [3] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin symbol (v4 or v5).
nusc-3d-det-val-2025-09-04-19-23-06-master-0:23:23 [2] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin_v6 symbol.
nusc-3d-det-val-2025-09-04-19-23-06-master-0:23:23 [2] NCCL INFO NET/Plugin: Failed to find ncclCollNetPlugin symbol (v4 or v5).
nusc-3d-det-val-2025-09-04-19-23-06-master-0:23:60 [2] NCCL INFO Plugin Path : /usr/local/nccl-rdma-sharp-plugins/lib/libnccl-net.so
nusc-3d-det-val-2025-09-04-19-23-06-master-0:23:60 [2] NCCL INFO P2P plugin IBext
nusc-3d-det-val-2025-09-04-19-23-06-master-0:24:59 [3] NCCL INFO Plugin Path : /usr/local/nccl-rdma-sharp-plugins/lib/libnccl-net.so
nusc-3d-det-val-2025-09-04-19-23-06-master-0:24:59 [3] NCCL INFO P2P plugin IBext
nusc-3d-det-val-2025-09-04-19-23-06-master-0:22:61 [1] NCCL INFO Plugin Path : /usr/local/nccl-rdma-sharp-plugins/lib/libnccl-net.so
nusc-3d-det-val-2025-09-04-19-23-06-master-0:22:61 [1] NCCL INFO P2P plugin IBext

nusc-3d-det-val-2025-09-04-19-23-06-master-0:23:60 [2] ibvwrap.c:66 NCCL WARN Call to ibv_open_device failed

nusc-3d-det-val-2025-09-04-19-23-06-master-0:24:59 [3] ibvwrap.c:66 NCCL WARN Call to ibv_open_device failed

nusc-3d-det-val-2025-09-04-19-23-06-master-0:22:61 [1] ibvwrap.c:66 NCCL WARN Call to ibv_open_device failed

nusc-3d-det-val-2025-09-04-19-23-06-master-0:23:60 [2] p2p_plugin.c:233 NCCL WARN NET/IB : Unable to open device mlx5_bond_0

nusc-3d-det-val-2025-09-04-19-23-06-master-0:24:59 [3] p2p_plugin.c:233 NCCL WARN NET/IB : Unable to open device mlx5_bond_0

nusc-3d-det-val-2025-09-04-19-23-06-master-0:22:61 [1] p2p_plugin.c:233 NCCL WARN NET/IB : Unable to open device mlx5_bond_0
nusc-3d-det-val-2025-09-04-19-23-06-master-0:23:60 [2] NCCL INFO NET/IB : No device found.
nusc-3d-det-val-2025-09-04-19-23-06-master-0:24:59 [3] NCCL INFO NET/IB : No device found.
nusc-3d-det-val-2025-09-04-19-23-06-master-0:22:61 [1] NCCL INFO NET/IB : No device found.
nusc-3d-det-val-2025-09-04-19-23-06-master-0:23:60 [2] NCCL INFO NCCL_IB_DISABLE set by environment to 1.
nusc-3d-det-val-2025-09-04-19-23-06-master-0:22:61 [1] NCCL INFO NCCL_IB_DISABLE set by environment to 1.
nusc-3d-det-val-2025-09-04-19-23-06-master-0:24:59 [3] NCCL INFO NCCL_IB_DISABLE set by environment to 1.
nusc-3d-det-val-2025-09-04-19-23-06-master-0:21:58 [0] NCCL INFO Plugin Path : /usr/local/nccl-rdma-sharp-plugins/lib/libnccl-net.so
nusc-3d-det-val-2025-09-04-19-23-06-master-0:21:58 [0] NCCL INFO P2P plugin IBext
nusc-3d-det-val-2025-09-04-19-23-06-master-0:23:60 [2] NCCL INFO NET/Socket : Using [0]eth0:10.245.119.196<0>
nusc-3d-det-val-2025-09-04-19-23-06-master-0:23:60 [2] NCCL INFO Using network Socket
nusc-3d-det-val-2025-09-04-19-23-06-master-0:22:61 [1] NCCL INFO NET/Socket : Using [0]eth0:10.245.119.196<0>
nusc-3d-det-val-2025-09-04-19-23-06-master-0:24:59 [3] NCCL INFO NET/Socket : Using [0]eth0:10.245.119.196<0>
nusc-3d-det-val-2025-09-04-19-23-06-master-0:24:59 [3] NCCL INFO Using network Socket
nusc-3d-det-val-2025-09-04-19-23-06-master-0:22:61 [1] NCCL INFO Using network Socket

nusc-3d-det-val-2025-09-04-19-23-06-master-0:21:58 [0] ibvwrap.c:66 NCCL WARN Call to ibv_open_device failed

nusc-3d-det-val-2025-09-04-19-23-06-master-0:21:58 [0] p2p_plugin.c:233 NCCL WARN NET/IB : Unable to open device mlx5_bond_0
nusc-3d-det-val-2025-09-04-19-23-06-master-0:21:58 [0] NCCL INFO NET/IB : No device found.
nusc-3d-det-val-2025-09-04-19-23-06-master-0:21:58 [0] NCCL INFO NCCL_IB_DISABLE set by environment to 1.
nusc-3d-det-val-2025-09-04-19-23-06-master-0:21:58 [0] NCCL INFO NET/Socket : Using [0]eth0:10.245.119.196<0>
nusc-3d-det-val-2025-09-04-19-23-06-master-0:21:58 [0] NCCL INFO Using network Socket
nusc-3d-det-val-2025-09-04-19-23-06-master-0:22:61 [1] NCCL INFO comm 0x1b56a0b0 rank 1 nranks 4 cudaDev 1 nvmlDev 1 busId 26000 commId 0xe887ec78cdf816d0 - Init START
nusc-3d-det-val-2025-09-04-19-23-06-master-0:24:59 [3] NCCL INFO comm 0x1fad3f30 rank 3 nranks 4 cudaDev 3 nvmlDev 3 busId ad000 commId 0xe887ec78cdf816d0 - Init START
nusc-3d-det-val-2025-09-04-19-23-06-master-0:21:58 [0] NCCL INFO comm 0x1a9cae70 rank 0 nranks 4 cudaDev 0 nvmlDev 0 busId 25000 commId 0xe887ec78cdf816d0 - Init START
nusc-3d-det-val-2025-09-04-19-23-06-master-0:23:60 [2] NCCL INFO comm 0x18613d40 rank 2 nranks 4 cudaDev 2 nvmlDev 2 busId a9000 commId 0xe887ec78cdf816d0 - Init START
nusc-3d-det-val-2025-09-04-19-23-06-master-0:22:61 [1] NCCL INFO Setting affinity for GPU 1 to ff0000,00000000,00ff0000
nusc-3d-det-val-2025-09-04-19-23-06-master-0:24:59 [3] NCCL INFO Setting affinity for GPU 3 to ff0000,00000000,00ff0000,00000000
nusc-3d-det-val-2025-09-04-19-23-06-master-0:21:58 [0] NCCL INFO Setting affinity for GPU 0 to ff0000,00000000,00ff0000
nusc-3d-det-val-2025-09-04-19-23-06-master-0:23:60 [2] NCCL INFO Setting affinity for GPU 2 to ff0000,00000000,00ff0000,00000000
nusc-3d-det-val-2025-09-04-19-23-06-master-0:23:60 [2] NCCL INFO Trees [0] 3/-1/-1->2->1 [1] 3/-1/-1->2->1 [2] 3/-1/-1->2->1 [3] 3/-1/-1->2->1
nusc-3d-det-val-2025-09-04-19-23-06-master-0:22:61 [1] NCCL INFO Trees [0] 2/-1/-1->1->0 [1] 2/-1/-1->1->0 [2] 2/-1/-1->1->0 [3] 2/-1/-1->1->0
nusc-3d-det-val-2025-09-04-19-23-06-master-0:21:58 [0] NCCL INFO Channel 00/04 :    0   1   2   3
nusc-3d-det-val-2025-09-04-19-23-06-master-0:24:59 [3] NCCL INFO Trees [0] -1/-1/-1->3->2 [1] -1/-1/-1->3->2 [2] -1/-1/-1->3->2 [3] -1/-1/-1->3->2
nusc-3d-det-val-2025-09-04-19-23-06-master-0:23:60 [2] NCCL INFO P2P Chunksize set to 131072
nusc-3d-det-val-2025-09-04-19-23-06-master-0:21:58 [0] NCCL INFO Channel 01/04 :    0   1   2   3
nusc-3d-det-val-2025-09-04-19-23-06-master-0:22:61 [1] NCCL INFO P2P Chunksize set to 131072
nusc-3d-det-val-2025-09-04-19-23-06-master-0:24:59 [3] NCCL INFO P2P Chunksize set to 131072
nusc-3d-det-val-2025-09-04-19-23-06-master-0:21:58 [0] NCCL INFO Channel 02/04 :    0   1   2   3
nusc-3d-det-val-2025-09-04-19-23-06-master-0:21:58 [0] NCCL INFO Channel 03/04 :    0   1   2   3
nusc-3d-det-val-2025-09-04-19-23-06-master-0:21:58 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1 [2] 1/-1/-1->0->-1 [3] 1/-1/-1->0->-1
nusc-3d-det-val-2025-09-04-19-23-06-master-0:21:58 [0] NCCL INFO P2P Chunksize set to 131072
nusc-3d-det-val-2025-09-04-19-23-06-master-0:24:59 [3] NCCL INFO Channel 00/0 : 3[3] -> 0[0] via P2P/IPC
nusc-3d-det-val-2025-09-04-19-23-06-master-0:23:60 [2] NCCL INFO Channel 00/0 : 2[2] -> 3[3] via P2P/IPC
nusc-3d-det-val-2025-09-04-19-23-06-master-0:22:61 [1] NCCL INFO Channel 00/0 : 1[1] -> 2[2] via P2P/IPC
nusc-3d-det-val-2025-09-04-19-23-06-master-0:21:58 [0] NCCL INFO Channel 00/0 : 0[0] -> 1[1] via P2P/IPC
nusc-3d-det-val-2025-09-04-19-23-06-master-0:24:59 [3] NCCL INFO Channel 01/0 : 3[3] -> 0[0] via P2P/IPC
nusc-3d-det-val-2025-09-04-19-23-06-master-0:23:60 [2] NCCL INFO Channel 01/0 : 2[2] -> 3[3] via P2P/IPC
nusc-3d-det-val-2025-09-04-19-23-06-master-0:22:61 [1] NCCL INFO Channel 01/0 : 1[1] -> 2[2] via P2P/IPC
nusc-3d-det-val-2025-09-04-19-23-06-master-0:21:58 [0] NCCL INFO Channel 01/0 : 0[0] -> 1[1] via P2P/IPC
nusc-3d-det-val-2025-09-04-19-23-06-master-0:24:59 [3] NCCL INFO Channel 02/0 : 3[3] -> 0[0] via P2P/IPC
nusc-3d-det-val-2025-09-04-19-23-06-master-0:23:60 [2] NCCL INFO Channel 02/0 : 2[2] -> 3[3] via P2P/IPC
nusc-3d-det-val-2025-09-04-19-23-06-master-0:22:61 [1] NCCL INFO Channel 02/0 : 1[1] -> 2[2] via P2P/IPC
nusc-3d-det-val-2025-09-04-19-23-06-master-0:21:58 [0] NCCL INFO Channel 02/0 : 0[0] -> 1[1] via P2P/IPC
nusc-3d-det-val-2025-09-04-19-23-06-master-0:24:59 [3] NCCL INFO Channel 03/0 : 3[3] -> 0[0] via P2P/IPC
nusc-3d-det-val-2025-09-04-19-23-06-master-0:23:60 [2] NCCL INFO Channel 03/0 : 2[2] -> 3[3] via P2P/IPC
nusc-3d-det-val-2025-09-04-19-23-06-master-0:22:61 [1] NCCL INFO Channel 03/0 : 1[1] -> 2[2] via P2P/IPC
nusc-3d-det-val-2025-09-04-19-23-06-master-0:21:58 [0] NCCL INFO Channel 03/0 : 0[0] -> 1[1] via P2P/IPC
nusc-3d-det-val-2025-09-04-19-23-06-master-0:22:61 [1] NCCL INFO Connected all rings
nusc-3d-det-val-2025-09-04-19-23-06-master-0:24:59 [3] NCCL INFO Connected all rings
nusc-3d-det-val-2025-09-04-19-23-06-master-0:24:59 [3] NCCL INFO Channel 00/0 : 3[3] -> 2[2] via P2P/IPC
nusc-3d-det-val-2025-09-04-19-23-06-master-0:23:60 [2] NCCL INFO Connected all rings
nusc-3d-det-val-2025-09-04-19-23-06-master-0:24:59 [3] NCCL INFO Channel 01/0 : 3[3] -> 2[2] via P2P/IPC
nusc-3d-det-val-2025-09-04-19-23-06-master-0:21:58 [0] NCCL INFO Connected all rings
nusc-3d-det-val-2025-09-04-19-23-06-master-0:24:59 [3] NCCL INFO Channel 02/0 : 3[3] -> 2[2] via P2P/IPC
nusc-3d-det-val-2025-09-04-19-23-06-master-0:24:59 [3] NCCL INFO Channel 03/0 : 3[3] -> 2[2] via P2P/IPC
nusc-3d-det-val-2025-09-04-19-23-06-master-0:22:61 [1] NCCL INFO Channel 00/0 : 1[1] -> 0[0] via P2P/IPC
nusc-3d-det-val-2025-09-04-19-23-06-master-0:23:60 [2] NCCL INFO Channel 00/0 : 2[2] -> 1[1] via P2P/IPC
nusc-3d-det-val-2025-09-04-19-23-06-master-0:22:61 [1] NCCL INFO Channel 01/0 : 1[1] -> 0[0] via P2P/IPC
nusc-3d-det-val-2025-09-04-19-23-06-master-0:23:60 [2] NCCL INFO Channel 01/0 : 2[2] -> 1[1] via P2P/IPC
nusc-3d-det-val-2025-09-04-19-23-06-master-0:22:61 [1] NCCL INFO Channel 02/0 : 1[1] -> 0[0] via P2P/IPC
nusc-3d-det-val-2025-09-04-19-23-06-master-0:23:60 [2] NCCL INFO Channel 02/0 : 2[2] -> 1[1] via P2P/IPC
nusc-3d-det-val-2025-09-04-19-23-06-master-0:22:61 [1] NCCL INFO Channel 03/0 : 1[1] -> 0[0] via P2P/IPC
nusc-3d-det-val-2025-09-04-19-23-06-master-0:23:60 [2] NCCL INFO Channel 03/0 : 2[2] -> 1[1] via P2P/IPC
nusc-3d-det-val-2025-09-04-19-23-06-master-0:21:58 [0] NCCL INFO Connected all trees
nusc-3d-det-val-2025-09-04-19-23-06-master-0:21:58 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
nusc-3d-det-val-2025-09-04-19-23-06-master-0:21:58 [0] NCCL INFO 4 coll channels, 0 nvls channels, 4 p2p channels, 2 p2p channels per peer
nusc-3d-det-val-2025-09-04-19-23-06-master-0:24:59 [3] NCCL INFO Connected all trees
nusc-3d-det-val-2025-09-04-19-23-06-master-0:24:59 [3] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
nusc-3d-det-val-2025-09-04-19-23-06-master-0:24:59 [3] NCCL INFO 4 coll channels, 0 nvls channels, 4 p2p channels, 2 p2p channels per peer
nusc-3d-det-val-2025-09-04-19-23-06-master-0:22:61 [1] NCCL INFO Connected all trees
nusc-3d-det-val-2025-09-04-19-23-06-master-0:22:61 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
nusc-3d-det-val-2025-09-04-19-23-06-master-0:22:61 [1] NCCL INFO 4 coll channels, 0 nvls channels, 4 p2p channels, 2 p2p channels per peer
nusc-3d-det-val-2025-09-04-19-23-06-master-0:23:60 [2] NCCL INFO Connected all trees
nusc-3d-det-val-2025-09-04-19-23-06-master-0:23:60 [2] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
nusc-3d-det-val-2025-09-04-19-23-06-master-0:23:60 [2] NCCL INFO 4 coll channels, 0 nvls channels, 4 p2p channels, 2 p2p channels per peer
nusc-3d-det-val-2025-09-04-19-23-06-master-0:21:58 [0] NCCL INFO comm 0x1a9cae70 rank 0 nranks 4 cudaDev 0 nvmlDev 0 busId 25000 commId 0xe887ec78cdf816d0 - Init COMPLETE
nusc-3d-det-val-2025-09-04-19-23-06-master-0:24:59 [3] NCCL INFO comm 0x1fad3f30 rank 3 nranks 4 cudaDev 3 nvmlDev 3 busId ad000 commId 0xe887ec78cdf816d0 - Init COMPLETE
nusc-3d-det-val-2025-09-04-19-23-06-master-0:23:60 [2] NCCL INFO comm 0x18613d40 rank 2 nranks 4 cudaDev 2 nvmlDev 2 busId a9000 commId 0xe887ec78cdf816d0 - Init COMPLETE
nusc-3d-det-val-2025-09-04-19-23-06-master-0:22:61 [1] NCCL INFO comm 0x1b56a0b0 rank 1 nranks 4 cudaDev 1 nvmlDev 1 busId 26000 commId 0xe887ec78cdf816d0 - Init COMPLETE
eval:   0%|          | 0/377 [00:00<?, ?it/s]Traceback (most recent call last):
  File "/mnt/csi-data-aly/user/hongfeizhang/mypaper/SparseFormerV2/tools/test.py", line 241, in <module>
    main()
  File "/mnt/csi-data-aly/user/hongfeizhang/mypaper/SparseFormerV2/tools/test.py", line 237, in main
    eval_single_ckpt(model, test_loader, args, eval_output_dir, logger, epoch_id, dist_test=dist_test)
  File "/mnt/csi-data-aly/user/hongfeizhang/mypaper/SparseFormerV2/tools/test.py", line 90, in eval_single_ckpt
    eval_utils.eval_one_epoch(
  File "/mnt/csi-data-aly/user/hongfeizhang/mypaper/SparseFormerV2/tools/eval_utils/eval_utils.py", line 160, in eval_one_epoch
    pred_dicts, ret_dict = model(batch_dict)
  File "/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1519, in forward
    else self._run_ddp_forward(*inputs, **kwargs)
  File "/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1355, in _run_ddp_forward
    return self.module(*inputs, **kwargs)  # type: ignore[index]
  File "/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/mnt/csi-data-aly/user/hongfeizhang/mypaper/SparseFormerV2/tools/../pcdet/models/detectors/transfusion.py", line 12, in forward
    batch_dict = cur_module(batch_dict)
  File "/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/mnt/csi-data-aly/user/hongfeizhang/mypaper/SparseFormerV2/tools/../pcdet/models/dense_heads/sparse_former_head.py", line 1016, in forward
    batch_dict['final_box_dicts'] = self.get_bboxes_v2(res_layer)
  File "/mnt/csi-data-aly/user/hongfeizhang/mypaper/SparseFormerV2/tools/../pcdet/models/dense_heads/sparse_former_head.py", line 1585, in get_bboxes_v2
    if self.dataset_name == "nuScenes":
  File "/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1695, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'SparseFormerHead' object has no attribute 'dataset_name'
Traceback (most recent call last):
  File "/mnt/csi-data-aly/user/hongfeizhang/mypaper/SparseFormerV2/tools/test.py", line 241, in <module>
    main()
  File "/mnt/csi-data-aly/user/hongfeizhang/mypaper/SparseFormerV2/tools/test.py", line 237, in main
    eval_single_ckpt(model, test_loader, args, eval_output_dir, logger, epoch_id, dist_test=dist_test)
  File "/mnt/csi-data-aly/user/hongfeizhang/mypaper/SparseFormerV2/tools/test.py", line 90, in eval_single_ckpt
    eval_utils.eval_one_epoch(
  File "/mnt/csi-data-aly/user/hongfeizhang/mypaper/SparseFormerV2/tools/eval_utils/eval_utils.py", line 160, in eval_one_epoch
    pred_dicts, ret_dict = model(batch_dict)
  File "/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1519, in forward
    else self._run_ddp_forward(*inputs, **kwargs)
  File "/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1355, in _run_ddp_forward
    return self.module(*inputs, **kwargs)  # type: ignore[index]
  File "/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/mnt/csi-data-aly/user/hongfeizhang/mypaper/SparseFormerV2/tools/../pcdet/models/detectors/transfusion.py", line 12, in forward
    batch_dict = cur_module(batch_dict)
  File "/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/mnt/csi-data-aly/user/hongfeizhang/mypaper/SparseFormerV2/tools/../pcdet/models/dense_heads/sparse_former_head.py", line 1016, in forward
    batch_dict['final_box_dicts'] = self.get_bboxes_v2(res_layer)
  File "/mnt/csi-data-aly/user/hongfeizhang/mypaper/SparseFormerV2/tools/../pcdet/models/dense_heads/sparse_former_head.py", line 1585, in get_bboxes_v2
    if self.dataset_name == "nuScenes":
  File "/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1695, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'SparseFormerHead' object has no attribute 'dataset_name'
Traceback (most recent call last):
  File "/mnt/csi-data-aly/user/hongfeizhang/mypaper/SparseFormerV2/tools/test.py", line 241, in <module>
    main()
  File "/mnt/csi-data-aly/user/hongfeizhang/mypaper/SparseFormerV2/tools/test.py", line 237, in main
    eval_single_ckpt(model, test_loader, args, eval_output_dir, logger, epoch_id, dist_test=dist_test)
  File "/mnt/csi-data-aly/user/hongfeizhang/mypaper/SparseFormerV2/tools/test.py", line 90, in eval_single_ckpt
    eval_utils.eval_one_epoch(
  File "/mnt/csi-data-aly/user/hongfeizhang/mypaper/SparseFormerV2/tools/eval_utils/eval_utils.py", line 160, in eval_one_epoch
    pred_dicts, ret_dict = model(batch_dict)
  File "/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1519, in forward
    else self._run_ddp_forward(*inputs, **kwargs)
  File "/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1355, in _run_ddp_forward
    return self.module(*inputs, **kwargs)  # type: ignore[index]
  File "/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/mnt/csi-data-aly/user/hongfeizhang/mypaper/SparseFormerV2/tools/../pcdet/models/detectors/transfusion.py", line 12, in forward
    batch_dict = cur_module(batch_dict)
  File "/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/mnt/csi-data-aly/user/hongfeizhang/mypaper/SparseFormerV2/tools/../pcdet/models/dense_heads/sparse_former_head.py", line 1016, in forward
    batch_dict['final_box_dicts'] = self.get_bboxes_v2(res_layer)
  File "/mnt/csi-data-aly/user/hongfeizhang/mypaper/SparseFormerV2/tools/../pcdet/models/dense_heads/sparse_former_head.py", line 1585, in get_bboxes_v2
    if self.dataset_name == "nuScenes":
  File "/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1695, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'SparseFormerHead' object has no attribute 'dataset_name'
eval:   0%|          | 0/377 [00:04<?, ?it/s]
Traceback (most recent call last):
  File "/mnt/csi-data-aly/user/hongfeizhang/mypaper/SparseFormerV2/tools/test.py", line 241, in <module>
    main()
  File "/mnt/csi-data-aly/user/hongfeizhang/mypaper/SparseFormerV2/tools/test.py", line 237, in main
    eval_single_ckpt(model, test_loader, args, eval_output_dir, logger, epoch_id, dist_test=dist_test)
  File "/mnt/csi-data-aly/user/hongfeizhang/mypaper/SparseFormerV2/tools/test.py", line 90, in eval_single_ckpt
    eval_utils.eval_one_epoch(
  File "/mnt/csi-data-aly/user/hongfeizhang/mypaper/SparseFormerV2/tools/eval_utils/eval_utils.py", line 160, in eval_one_epoch
    pred_dicts, ret_dict = model(batch_dict)
  File "/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1519, in forward
    else self._run_ddp_forward(*inputs, **kwargs)
  File "/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1355, in _run_ddp_forward
    return self.module(*inputs, **kwargs)  # type: ignore[index]
  File "/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/mnt/csi-data-aly/user/hongfeizhang/mypaper/SparseFormerV2/tools/../pcdet/models/detectors/transfusion.py", line 12, in forward
    batch_dict = cur_module(batch_dict)
  File "/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/mnt/csi-data-aly/user/hongfeizhang/mypaper/SparseFormerV2/tools/../pcdet/models/dense_heads/sparse_former_head.py", line 1016, in forward
    batch_dict['final_box_dicts'] = self.get_bboxes_v2(res_layer)
  File "/mnt/csi-data-aly/user/hongfeizhang/mypaper/SparseFormerV2/tools/../pcdet/models/dense_heads/sparse_former_head.py", line 1585, in get_bboxes_v2
    if self.dataset_name == "nuScenes":
  File "/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1695, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'SparseFormerHead' object has no attribute 'dataset_name'
[2025-09-04 19:23:37,000] torch.distributed.elastic.multiprocessing.api: [ERROR] failed (exitcode: 1) local_rank: 0 (pid: 21) of binary: /root/miniconda3/envs/sparseformerv2/bin/python
Traceback (most recent call last):
  File "/root/miniconda3/envs/sparseformerv2/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/root/miniconda3/envs/sparseformerv2/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/distributed/launch.py", line 196, in <module>
    main()
  File "/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/distributed/launch.py", line 192, in main
    launch(args)
  File "/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/distributed/launch.py", line 177, in launch
    run(args)
  File "/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/distributed/run.py", line 797, in run
    elastic_launch(
  File "/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 134, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/root/miniconda3/envs/sparseformerv2/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 264, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
/mnt/csi-data-aly/user/hongfeizhang/mypaper/SparseFormerV2/tools/test.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2025-09-04_19:23:36
  host      : nusc-3d-det-val-2025-09-04-19-23-06-master-0
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 22)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2025-09-04_19:23:36
  host      : nusc-3d-det-val-2025-09-04-19-23-06-master-0
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 23)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2025-09-04_19:23:36
  host      : nusc-3d-det-val-2025-09-04-19-23-06-master-0
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 24)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2025-09-04_19:23:36
  host      : nusc-3d-det-val-2025-09-04-19-23-06-master-0
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 21)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
